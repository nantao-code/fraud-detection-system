# ğŸ¯ æ˜“å—è¯ˆäººç¾¤è¯†åˆ«ç³»ç»Ÿ - å®Œæ•´æ–‡æ¡£

> **ğŸ‰ æœ€æ–°æ›´æ–°**: ç³»ç»Ÿå·²å®Œæˆå…¨é¢é‡æ„ï¼Œè§£å†³äº†æ•°æ®æ³„éœ²é—®é¢˜ï¼Œæ”¯æŒPMMLè½¬æ¢å’Œè¯„åˆ†å¡åŠŸèƒ½ï¼Œå¯ç›´æ¥ç”¨äºç”Ÿäº§ç¯å¢ƒï¼

## ğŸ“‹ ç›®å½•
- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [é…ç½®æŒ‡å—](#é…ç½®æŒ‡å—)
- [ä½¿ç”¨æ•™ç¨‹](#ä½¿ç”¨æ•™ç¨‹)
- [APIæ–‡æ¡£](#apiæ–‡æ¡£)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [ç‰ˆæœ¬æ›´æ–°](#ç‰ˆæœ¬æ›´æ–°)

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªä¸“ä¸ºæ”¿ä¼å®¢æˆ·è®¾è®¡çš„**æ˜“å—è¯ˆäººç¾¤è¯†åˆ«ç³»ç»Ÿ**ï¼ŒåŸºäºæœºå™¨å­¦ä¹ æŠ€æœ¯æ„å»ºï¼Œæä¾›ä»æ•°æ®é¢„å¤„ç†ã€ç‰¹å¾å·¥ç¨‹ã€æ¨¡å‹è®­ç»ƒã€æ¨¡å‹ä¼˜åŒ–åˆ°éƒ¨ç½²ç›‘æ§çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚

### ğŸš€ æ ¸å¿ƒä¼˜åŠ¿
- **é›¶æ•°æ®æ³„éœ²**: ä¿®å¤äº†ç‰¹å¾å·¥ç¨‹ä¸­çš„æ•°æ®æ³„éœ²é—®é¢˜
- **å¤šæ ¼å¼æ”¯æŒ**: æ”¯æŒPMMLã€è¯„åˆ†å¡ã€Joblibç­‰å¤šç§æ¨¡å‹æ ¼å¼
- **ç”Ÿäº§å°±ç»ª**: å¯ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
- **ç›‘æ§å®Œå–„**: å†…ç½®æ¨¡å‹ç›‘æ§å’Œæ€§èƒ½è¿½è¸ª

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. æ¨¡å‹è®­ç»ƒä¸ä¼˜åŒ–
- **å¤šç®—æ³•æ”¯æŒ**: LRã€XGBoostã€éšæœºæ£®æ—ã€LightGBM
- **è¶…å‚æ•°ä¼˜åŒ–**: åŸºäºOptunaçš„è´å¶æ–¯ä¼˜åŒ–
- **ç‰¹å¾å·¥ç¨‹**: å·¥ä¸šçº§ç‰¹å¾é€‰æ‹©å’Œé¢„å¤„ç†
- **ä¸å¹³è¡¡å¤„ç†**: SMOTEã€ADASYNã€éšæœºè¿‡é‡‡æ ·/æ¬ é‡‡æ ·

### 2. æ¨¡å‹è½¬æ¢ä¸éƒ¨ç½²
- **PMMLè½¬æ¢**: æ”¯æŒæ‰€æœ‰ä¸»æµæ¨¡å‹è½¬æ¢ä¸ºPMMLæ ¼å¼
- **è¯„åˆ†å¡è½¬æ¢**: é€»è¾‘å›å½’è¯„åˆ†å¡ã€å†³ç­–æ ‘è¯„åˆ†å¡
- **APIæœåŠ¡**: RESTful APIæ¥å£
- **æ¨¡å‹ç›‘æ§**: æ€§èƒ½ç›‘æ§ã€æ•°æ®æ¼‚ç§»æ£€æµ‹

### 3. æ‰¹é‡è®­ç»ƒä¸æµ‹è¯•
- **å‚æ•°ç½‘æ ¼æµ‹è¯•**: å¤šå‚æ•°ç»„åˆå¹¶è¡Œæµ‹è¯•
- **å¤šè¿›ç¨‹å¹¶è¡Œ**: å……åˆ†åˆ©ç”¨CPUèµ„æº
- **ç»“æœæ±‡æ€»**: è¯¦ç»†çš„è®­ç»ƒç»“æœæŠ¥å‘Š

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

```bash
# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. éªŒè¯å®‰è£…
python check_pmml_env.py
```

### åŸºç¡€ä½¿ç”¨

#### æ–¹æ³•1ï¼šç›´æ¥ä½¿ç”¨è¯„åˆ†å¡ï¼ˆæ¨èï¼‰
```python
# è¯„åˆ†å¡å·²ç”Ÿæˆï¼Œç«‹å³å¯ç”¨
from output.simple_scorecard import SimpleCreditScorecard

scorecard = SimpleCreditScorecard()
result = scorecard.predict_proba({
    "V2": 0.5, "V3": -0.3, "V4": 1.2, "V7": -0.8,
    "V9": 0.1, "V10": 0.7, "V11": -0.5, "V12": 0.9,
    "V14": -1.2, "V16": 0.3, "V17": -0.7, "V18": 0.4
})

print(f"ä¿¡ç”¨åˆ†æ•°: {result['score']}")
print(f"è¿çº¦æ¦‚ç‡: {result['probability']:.2%}")
print(f"é£é™©ç­‰çº§: {result['risk_level']}")
```

#### æ–¹æ³•2ï¼šè®­ç»ƒæ–°æ¨¡å‹
```bash
# å•æ¨¡å‹è®­ç»ƒ
python main.py --config config.yaml --model LR

# æ‰¹é‡è®­ç»ƒæµ‹è¯•
python batch_training.py --config batch_config.yaml --max-workers 4
```

#### æ–¹æ³•3ï¼šå¯åŠ¨APIæœåŠ¡
```bash
# å¯åŠ¨FastAPIæœåŠ¡
uvicorn src.api_service:app --host 0.0.0.0 --port 8000
```

## ğŸ“ ç³»ç»Ÿæ¶æ„

```
æ˜“å—è¯ˆäººç¾¤è¯†åˆ«/
â”œâ”€â”€ src/                          # æ ¸å¿ƒæºä»£ç 
â”‚   â”œâ”€â”€ feature_engineering.py    # ç‰¹å¾å·¥ç¨‹ï¼ˆå·²ä¿®å¤æ•°æ®æ³„éœ²ï¼‰
â”‚   â”œâ”€â”€ model_training.py         # æ¨¡å‹è®­ç»ƒ
â”‚   â”œâ”€â”€ pipeline_training.py      # ç®¡é“è®­ç»ƒ
â”‚   â”œâ”€â”€ model_converter.py      # æ¨¡å‹è½¬æ¢
â”‚   â”œâ”€â”€ api_service.py          # APIæœåŠ¡
â”‚   â””â”€â”€ ...
â”œâ”€â”€ examples/                   # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ converted_models/           # è½¬æ¢åçš„æ¨¡å‹
â”œâ”€â”€ models/                     # è®­ç»ƒå¥½çš„æ¨¡å‹
â”œâ”€â”€ data/                       # æ•°æ®æ–‡ä»¶
â”œâ”€â”€ logs/                       # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ output/                     # è¯„åˆ†å¡è¾“å‡º
â”œâ”€â”€ config.yaml                 # é…ç½®æ–‡ä»¶
â”œâ”€â”€ batch_config.yaml          # æ‰¹é‡è®­ç»ƒé…ç½®
â””â”€â”€ README.md                  # æœ¬æ–‡æ¡£
```

## âš™ï¸ é…ç½®æŒ‡å—

### ä¸»é…ç½®æ–‡ä»¶ (config.yaml)

```yaml
# è·¯å¾„é…ç½®
paths:
  input_data: "data/creditcard.csv"
  model_output: "models/{input_data}_{imbalance_method}_{model_name}_model.joblib"
  report_output: "reports/{input_data}_{imbalance_method}_model_comparison.csv"

# æ¨¡å‹é…ç½®
modeling:
  models: ["LR", "XGB", "RF", "LGB"]
  imbalance_method: "smote"
  handle_imbalance: true
  use_hyperparameter_tuning: false
  optimization_trials: 50

# ç‰¹å¾å·¥ç¨‹é…ç½®
feature_engineering:
  target_column: "Class"
  iv_threshold: 0.1
  corr_threshold: 0.8
  missing_rate_threshold: 0.3
  handle_outliers: true
  transform_features: true
  scale_features: true
  create_binning_features: true

# ç›‘æ§é…ç½®
monitoring:
  performance_thresholds:
    accuracy: 0.75
    precision: 0.70
    recall: 0.65
    auc: 0.80
```

### æ‰¹é‡è®­ç»ƒé…ç½® (batch_config.yaml)

```yaml
parameter_grid:
  preprocessing.handle_imbalance_method:
    - "smote"
    - "random_over"
    - "none"
  preprocessing.feature_selection.threshold:
    - 0.85
    - 0.9
    - 0.95

models:
  - "XGB"
  - "RF"
  - "LR"
```

## ğŸ“– ä½¿ç”¨æ•™ç¨‹

### 1. æ•°æ®é¢„å¤„ç†ï¼ˆå·²ä¿®å¤æ•°æ®æ³„éœ²ï¼‰

#### é—®é¢˜ä¿®å¤
- **ä¿®å¤å‰**: ä½¿ç”¨`fit_transform`åŒæ—¶å¤„ç†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå­˜åœ¨æ•°æ®æ³„éœ²
- **ä¿®å¤å**: ä½¿ç”¨`fit`åœ¨è®­ç»ƒé›†å­¦ä¹ è§„åˆ™ï¼Œ`transform`åº”ç”¨è§„åˆ™åˆ°æµ‹è¯•é›†

#### ä½¿ç”¨ç¤ºä¾‹
```python
from src.feature_engineering import FeatureEngineeringPipeline

# åˆ›å»ºç®¡é“ï¼ˆscikit-learnå…¼å®¹ï¼‰
pipeline = FeatureEngineeringPipeline(config)

# å­¦ä¹ è½¬æ¢è§„åˆ™ï¼ˆä»…è®­ç»ƒé›†ï¼‰
pipeline.fit(X_train, y_train)

# åº”ç”¨è½¬æ¢è§„åˆ™ï¼ˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼‰
X_train_processed = pipeline.transform(X_train)
X_test_processed = pipeline.transform(X_test)
```

### 2. æ¨¡å‹è®­ç»ƒ

#### å•æ¨¡å‹è®­ç»ƒ
```python
from src.model_training import TrainingPipeline

# åˆ›å»ºè®­ç»ƒå™¨
trainer = TrainingPipeline(config)

# è®­ç»ƒå•ä¸ªæ¨¡å‹
model, results = trainer.run_single_model("LR")

# è®­ç»ƒæ‰€æœ‰æ¨¡å‹
results = trainer.run_all_models()
```

#### æ‰¹é‡è®­ç»ƒæµ‹è¯•
```bash
# é¢„è§ˆä»»åŠ¡
python batch_training.py --config batch_config.yaml --dry-run

# æ‰§è¡Œæ‰¹é‡è®­ç»ƒ
python batch_training.py --config batch_config.yaml --max-workers 4
```

### 3. æ¨¡å‹è½¬æ¢

#### è¯„åˆ†å¡è½¬æ¢ï¼ˆæ¨èï¼‰
```python
from src.model_converter import ModelConverter

converter = ModelConverter()

# è½¬æ¢ä¸ºè¯„åˆ†å¡
scorecard = converter.convert_to_scorecard(
    "LR", X_train, y_train, "dataset_name"
)

# ä½¿ç”¨è¯„åˆ†å¡
result = scorecard.predict_proba(customer_data)
```

#### PMMLè½¬æ¢
```python
# è½¬æ¢ä¸ºPMML
pmml_path = converter.convert_to_pmml(
    model, numeric_features, categorical_features, "dataset_name"
)
```

### 4. APIæœåŠ¡

#### å¯åŠ¨æœåŠ¡
```bash
uvicorn src.api_service:app --host 0.0.0.0 --port 8000
```

#### APIè°ƒç”¨ç¤ºä¾‹
```python
import requests

# å•æ¡é¢„æµ‹
response = requests.post("http://localhost:8000/predict", json={
    "features": [1.0, 2.0, 3.0, 4.0, 5.0]
})

# æ‰¹é‡é¢„æµ‹
response = requests.post("http://localhost:8000/predict/batch", json={
    "data": [[1.0, 2.0, 3.0], [2.0, 3.0, 4.0]]
})
```

## ğŸ“Š è¾“å‡ºæ–‡ä»¶è¯´æ˜

### è®­ç»ƒè¾“å‡º
- **æ¨¡å‹æ–‡ä»¶**: `models/{dataset}_{method}_{model}_model.joblib`
- **ç‰¹å¾åˆ—è¡¨**: `features/{dataset}_{method}_{model}_final_features.json`
- **è®­ç»ƒæŠ¥å‘Š**: `logs/batch_training_results_*.json`

### è½¬æ¢è¾“å‡º
- **è¯„åˆ†å¡**: `output/simple_scorecard.py`
- **è¯„åˆ†å¡é…ç½®**: `output/scorecard_config.json`
- **ç‰¹å¾é‡è¦æ€§**: `output/feature_importance.csv`
- **PMMLæ–‡ä»¶**: `converted_models/pmml/*.pmml`

### ç›‘æ§è¾“å‡º
- **æ€§èƒ½æ—¥å¿—**: `logs/model_performance_*.json`
- **æ¼‚ç§»æ£€æµ‹**: `logs/drift_detection_*.json`
- **é¢„æµ‹æ—¥å¿—**: `logs/predictions_*.json`

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. Javaç‰ˆæœ¬é—®é¢˜ï¼ˆPMMLè½¬æ¢ï¼‰
**é—®é¢˜**: `java.lang.UnsupportedClassVersionError`
**è§£å†³**:
```bash
# ä½¿ç”¨ç®€åŒ–ç‰ˆè¯„åˆ†å¡ï¼ˆæ— éœ€Javaï¼‰
python convert_without_pmml.py --model models/model.joblib --features features/final_features.json
```

#### 2. æ•°æ®æ³„éœ²è­¦å‘Š
**è§£å†³**: å·²ä¿®å¤ï¼ä½¿ç”¨æ–°çš„`FeatureEngineeringPipeline`ç±»

#### 3. å†…å­˜ä¸è¶³
**è§£å†³**: 
- å‡å°‘å¹¶è¡Œè¿›ç¨‹æ•°ï¼š`--max-workers 2`
- ä½¿ç”¨æ•°æ®é‡‡æ ·
- æ£€æŸ¥å†…å­˜æ³„æ¼

#### 4. ç‰¹å¾ä¸åŒ¹é…
**è§£å†³**: 
- ç¡®ä¿ç‰¹å¾é…ç½®æ–‡ä»¶ä¸æ¨¡å‹è®­ç»ƒæ—¶ä¸€è‡´
- æ£€æŸ¥æ•°æ®æ ¼å¼

### ç¯å¢ƒæ£€æŸ¥
```bash
# è¿è¡Œç¯å¢ƒæ£€æŸ¥è„šæœ¬
python check_pmml_env.py
```

## ğŸ“ˆ ç‰ˆæœ¬æ›´æ–°

### v3.0.0 (å½“å‰ç‰ˆæœ¬)
- âœ… **æ•°æ®æ³„éœ²ä¿®å¤**: é‡æ„ç‰¹å¾å·¥ç¨‹ç®¡é“
- âœ… **PMMLæ”¯æŒ**: æ”¯æŒæ‰€æœ‰æ¨¡å‹æ ¼å¼è½¬æ¢
- âœ… **è¯„åˆ†å¡åŠŸèƒ½**: é›¶ä¾èµ–çš„è¯„åˆ†å¡ç³»ç»Ÿ
- âœ… **APIæœåŠ¡**: RESTful APIæ¥å£
- âœ… **ç›‘æ§å®Œå–„**: æ¨¡å‹æ€§èƒ½ç›‘æ§

### v2.0.0
- âœ… è¯„åˆ†å¡è½¬æ¢åŠŸèƒ½
- âœ… æ‰¹é‡è®­ç»ƒæµ‹è¯•
- âœ… è¶…å‚æ•°ä¼˜åŒ–

### v1.0.0
- âœ… åŸºç¡€æ¨¡å‹è®­ç»ƒ
- âœ… ç‰¹å¾å·¥ç¨‹
- âœ… æ¨¡å‹è¯„ä¼°

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### å¿«é€ŸéªŒè¯
```bash
# 1. éªŒè¯ç¯å¢ƒ
python check_pmml_env.py

# 2. è¿è¡Œç¤ºä¾‹
python run_conversion_example.py

# 3. æµ‹è¯•API
python -c "import requests; print(requests.get('http://localhost:8000/health').json())"
```

### æ–‡æ¡£èµ„æº
- **å¿«é€Ÿå¼€å§‹**: è§`QUICK_START.md`
- **é…ç½®æŒ‡å—**: è§`CONFIG_GUIDE.md`
- **æ•…éšœæ’é™¤**: è§`PMML_TROUBLESHOOTING.md`

### è”ç³»æ”¯æŒ
- **é¡¹ç›®ç»´æŠ¤**: ç³»ç»Ÿå·²å®Œå…¨æ–‡æ¡£åŒ–
- **æŠ€æœ¯æ”¯æŒ**: æŸ¥çœ‹å„æ¨¡å—çš„è¯¦ç»†æ–‡æ¡£

---

## ğŸ¯ ç«‹å³å¼€å§‹ä½¿ç”¨

**è¯„åˆ†å¡å·²ç”Ÿæˆï¼Œç«‹å³å¯ç”¨ï¼**

```python
# æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼
from output.simple_scorecard import SimpleCreditScorecard

scorecard = SimpleCreditScorecard()
print("è¯„åˆ†å¡å·²å°±ç»ªï¼Œå¯ç›´æ¥ç”¨äºç”Ÿäº§ç¯å¢ƒï¼")
```

**ğŸ‰ æ­å–œï¼æ‚¨ç°åœ¨æ‹¥æœ‰ä¸€ä¸ªå®Œæ•´çš„ã€ç”Ÿäº§å°±ç»ªçš„æ˜“å—è¯ˆäººç¾¤è¯†åˆ«ç³»ç»Ÿï¼**